// 1. ตั้งค่า Client
generator client {
  provider = "prisma-client-js"
}

// 2. ตั้งค่า Database (SQLite)
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- MODELS (ตารางข้อมูล) ---

model Product {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  price       Decimal
  imageUrl    String
  category    String
  
  // ประเภทสินค้า: "TOPUP", "ID_ACCOUNT"
  type        String   
  
  // ส่วนลด (%) ที่เพิ่มมาล่าสุด
  discount    Int      @default(0) 

 images      String   @default("[]")

 options     String   @default("[]")

  stockItems  StockItem[]
  orderItems  OrderItem[]
  createdAt   DateTime @default(now())
}

model StockItem {
  id        Int      @id @default(autoincrement())
  productId Int
  product   Product  @relation(fields: [productId], references: [id])
  content   String   // รหัส/ไอดีที่จะขาย
  isSold    Boolean  @default(false)
}

model Order {
  id             String      @id @default(uuid())
  
  // ช่องทางติดต่อ: "EMAIL", "SMS", "mixed"
  contactChannel String      
  contactValue   String
  
  // สถานะ: "PENDING", "PAID", "VERIFYING", "FAILED", "CANCELLED"
  // ใช้ String ทำให้รองรับคำว่า "VERIFYING" ได้ทันทีครับ
  status         String      
  
  totalAmount    Decimal
  orderItems     OrderItem[]
  createdAt      DateTime    @default(now())
}

model OrderItem {
  id               Int     @id @default(autoincrement())
  orderId          String
  order            Order   @relation(fields: [orderId], references: [id])
  productId        Int
  product          Product @relation(fields: [productId], references: [id])
  
  // ข้อมูลที่ลูกค้ากรอกมา (เช่น UID เกม)
  userInput        String? 
  
  // รหัสสินค้าที่ส่งให้ลูกค้าแล้ว
  deliveredContent String? 
}